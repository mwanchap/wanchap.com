+++
title = "Using WiX to create an event source during install of a .NET framework project"
date = 2013-10-31T16:56:00Z
updated = 2017-10-27T17:41:46Z
blogimport = true 
[author]
	name = "Matt Wanchap"
	uri = "https://www.blogger.com/profile/16465307324394182190"
+++

<i>Edit: so I guess I wasn't the only one confused with this stuff, as it's been my most popular post by far! &nbsp;If I've helped you out or saved you some time, please let me know in the comments :)</i><br /><br />In order for this to work, you have to add references to WixUtilExtension and WixNetFxExtension to your WiX project. &nbsp;Once that's done, add this inside a&nbsp;<span style="color: blue; font-family: &quot;consolas&quot;; font-size: 13px;">&lt;</span><span style="color: #a31515; font-family: &quot;consolas&quot;; font-size: 13px;">Component</span><span style="color: blue; font-family: &quot;consolas&quot;; font-size: 13px;">&gt;</span>&nbsp;element:<br /><br /><pre style="background-position: initial initial; background-repeat: initial initial; font-family: Consolas; font-size: 13px;"><span style="color: blue;">&lt;</span><span style="color: #a31515;">Util:EventSource</span><span style="color: blue;">&nbsp;</span><span style="color: red;">xmlns:Util</span><span style="color: blue;">=</span>"<span style="color: blue;">http://schemas.microsoft.com/wix/UtilExtension</span>"<span style="color: blue;">&nbsp;</span><span style="color: red;">Name</span><span style="color: blue;">=</span>"<span style="color: blue; line-height: 18px;">EVENTSOURCEGOESHERE</span>"<span style="color: blue;">&nbsp;</span><span style="color: red;">Log</span><span style="color: blue;">=</span>"<span style="color: blue;">Application</span>"<span style="color: blue;">&nbsp;</span><span style="color: red;">EventMessageFile</span><span style="color: blue;">=</span>"<span style="color: blue;">[NETFRAMEWORK40FULLINSTALLROOTDIR]EventLogMessages.dll</span>"<span style="color: blue;">&nbsp;/&gt;</span></pre><br />Obviously replace&nbsp;<span style="color: blue; font-family: &quot;consolas&quot;; font-size: 13px; line-height: 18px;">EVENTSOURCEGOESHERE&nbsp;</span>with your event source name. &nbsp;<span style="color: blue; font-family: &quot;consolas&quot;; font-size: 13px;">NETFRAMEWORK40FULLINSTALLROOTDIR</span>&nbsp;is a property set by the WixNetFxExtension which stores the path to the .NET framework v4 directory, but you can replace this with the corresponding property for the directory containing the relevant EventLogMessages.dll file. &nbsp;So if you're using the .NET framework as I was in this example, you'll also need to add a property for it inside the&nbsp;<span style="color: blue; font-family: &quot;consolas&quot;; font-size: 13px;">&lt;</span><span style="color: #a31515; font-family: &quot;consolas&quot;; font-size: 13px;">Product</span><span style="color: blue; font-family: &quot;consolas&quot;; font-size: 13px;">&gt;</span>&nbsp;element:<br /><br /><pre style="background-position: initial initial; background-repeat: initial initial; font-family: Consolas; font-size: 13px;"><span style="color: blue;">&lt;</span><span style="color: #a31515;">PropertyRef</span><span style="color: blue;">&nbsp;</span><span style="color: red;">Id</span><span style="color: blue;">=</span>"<span style="color: blue;">NETFRAMEWORK40FULLINSTALLROOTDIR</span>"<span style="color: blue;">&nbsp;/&gt;</span><br /></pre>A complete list of available properties in the WixNetFxExtension is available at &nbsp;<a href="http://wixtoolset.org/documentation/manual/v3/customactions/wixnetfxextension.html">http://wixtoolset.org/documentation/manual/v3/customactions/wixnetfxextension.html</a><br /><div><br /></div>
