+++
title = "Docker + ASP.NET MVC Hello world - abridged edition"
date = 2018-12-26T19:42:00Z
updated = 2020-03-13T22:45:48Z
blogimport = true 
[author]
	name = "Matt Wanchap"
	uri = "https://www.blogger.com/profile/16465307324394182190"
+++

Here's the exact steps to get the ASP.NET MVC sample application running in a Docker container in Windows 10, abridged from the Microsoft tutorial <a href="https://docs.microsoft.com/en-us/aspnet/mvc/overview/deployment/docker-aspnetmvc" target="_blank">here</a>.&nbsp; I used a fresh Azure VM to avoid the many weird issues I kept running into with my bizarrely-screwy desktop, because of course it is.<div><br /></div><div>$ip = (New-AzureRmVm -Name dockertest -Credential (Get-Credential) | Get-AzureRmPublicIpAddress); "Remote desktop to: " + $ip.IpAddress; mstsc -v $ip.IpAddress</div><div><div><div><br /></div><div><div>Next, <a href="https://chocolatey.org/install#installing-chocolatey" target="_blank">install chocolatey</a>, then install everything else:</div><div>choco install visualstudio2017professional visualstudio2017-workload-netweb docker docker-desktop -y</div><div>Sign out and back in again, run docker desktop as admin, right-click the tray icon and switch to windows containers, let it enable hyper-v and reboot.&nbsp; Run docker desktop as admin again.</div></div><div><br /></div><div>Open Visual Studio, create a new project using the ASP.NET template and let it add all the MVC stuff.</div><div>Create a publish profile, publishing files to the default location of /bin/Release/Publish</div><div>Create a file in the project directory called "dockerfile", which should contain this:</div><div>FROM microsoft/aspnet</div><div>COPY ./bin/Release/Publish/ /inetpub/wwwroot</div><div><br /></div><div>Open cmd/powershell/whatever and cd over to the directory containing the dockerfile you made earlier, then build your container image and run it:</div><div>docker build -t hello-asp .</div><div>docker run -d --name hello -p 8080:80 hello-asp</div><div>Open a browser to http://localhost:8080, and you're done</div></div><div><br /></div></div><div>(Don't forget to delete that VM afterwards)</div><div><br /></div><div>In general, Docker has pretty unhelpful error messages, they're usually some version of: "cannot find the file specified", or "the process cannot access the file".&nbsp; Ignore them and go look for people discussing the error message on Stack Overflow / Github. I guarantee you it'll be some tiny dumb thing like all of the below.</div><div><br /></div><div>Solutions I came across:</div><div>Always run docker as admin, otherwise it'll misbehave in pretty weird ways.</div><div>"The daemon is not running" (when it totally is) - exit Docker desktop and re-run as admin.</div><div>If a "docker run" command fails with the message "failed to create endpoint on network ... HNS failed with error: the process cannot access the file".&nbsp; It just means you're reusing a port number that's already used.</div><div>Don't put the port number at the end of a "docker run" command or IIS won't start properly</div><div>In general if you get weird behaviour, just look very carefully at your parameter formatting, try reordering parameters, you might be surprised how often this is the problem.</div><div>To look at output from a container: add the "-it" parameters to a "docker run" command</div>
