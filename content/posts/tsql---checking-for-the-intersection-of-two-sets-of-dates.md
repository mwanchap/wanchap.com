+++
title = "TSQL - checking for the intersection of two sets of dates"
date = 2014-01-19T18:27:00Z
updated = 2014-05-01T18:39:23Z
tags = ["T-SQL"]
blogimport = true 
[author]
	name = "Matt Wanchap"
	uri = "https://www.blogger.com/profile/16465307324394182190"
+++

Double post day!<br /><br />The same query that had concatenation happening from the previous post also had date range parameters, @StartDate and @EndDate, and needed to only return records (which also had their own start/end date fields) in which the records' were active during the specified date range. &nbsp;I.e. where the record's date range intersected with the date range parameters. &nbsp;It confused me for a bit so I'm recording for posterity. As I see it, there are three possible valid cases:<br /><br />Case 1: Record's start date is within the date range<br /><br /><div class="separator" style="clear: both; text-align: left;"><a href="http://4.bp.blogspot.com/-YytsEs37M9g/UtyGoRoK7mI/AAAAAAAAAGY/W2n5Eyaxq2Y/s1600/case1.JPG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-YytsEs37M9g/UtyGoRoK7mI/AAAAAAAAAGY/W2n5Eyaxq2Y/s1600/case1.JPG" height="203" width="640" /></a></div><div><br /></div><div><br /></div><div>Case 2: Record's end is within the date range<br /><br /></div><div class="separator" style="clear: both; text-align: left;"><a href="http://1.bp.blogspot.com/-aF_Ny3OuQQ4/UtyGopTqiXI/AAAAAAAAAGc/W57xFR4xSyQ/s1600/case2.JPG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-aF_Ny3OuQQ4/UtyGopTqiXI/AAAAAAAAAGc/W57xFR4xSyQ/s1600/case2.JPG" height="201" width="640" /></a></div><div><br />Case 3: Record's end IS NULL (i.e. still currently active) and record's start is less than the end of the date range<br /><br /><div class="separator" style="clear: both; text-align: left;"><a href="http://3.bp.blogspot.com/-sbvGHJ6PO3k/UtyGo2GhFSI/AAAAAAAAAGg/3dUncpUY4vs/s1600/case3.JPG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-sbvGHJ6PO3k/UtyGo2GhFSI/AAAAAAAAAGg/3dUncpUY4vs/s1600/case3.JPG" height="200" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div>So expressed in code, these three cases looked like this:<br /><br /><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">SELECT </span><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">SomeFields<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">FROM</span><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">&nbsp;  SomeTable t<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><br /></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: green; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">--case 1<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">WHERE </span><span style="color: grey; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">((</span><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">t<span style="color: grey;">.</span>Start <span style="color: grey;">&gt;=</span>@StartDate<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: grey; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">AND</span><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">&nbsp;&nbsp; t<span style="color: grey;">.</span>Start <span style="color: grey;">&lt;</span> @EndDate<span style="color: grey;">)<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><br /></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: green; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">--case 2<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: grey; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">OR</span><span style="color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: grey; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">(</span><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">t<span style="color: grey;">.</span>End <span style="color: grey;">&gt;</span> @StartDate<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: grey; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">AND</span><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">&nbsp;&nbsp; t<span style="color: grey;">.</span>End <span style="color: grey;">&lt;=</span> @EndDate<span style="color: grey;">)<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><br /></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: green; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">--case 3<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"><span style="color: grey; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">OR</span><span style="color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: grey; font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">(</span><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; mso-no-proof: yes;">t<span style="color: grey;">.</span>End <span style="color: grey;">IS</span> <span style="color: grey;">NULL<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0.0001pt;"></div><div class="MsoNormal"><span style="color: grey; font-family: &quot;Courier New&quot;; font-size: 10.0pt; line-height: 107%; mso-no-proof: yes;">AND</span><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; line-height: 107%; mso-no-proof: yes;">&nbsp;&nbsp; t<span style="color: grey;">.</span>Start <span style="color: grey;">&lt;</span> @EndDate<span style="color: grey;">))</span></span><span style="color: red; font-family: &quot;Courier New&quot;; font-size: 8.0pt; line-height: 107%; mso-no-proof: yes;"><o:p></o:p></span></div><div class="MsoNormal"><span style="font-family: &quot;Courier New&quot;; font-size: 10.0pt; line-height: 107%; mso-no-proof: yes;"><span style="color: grey;"><br /></span></span></div><div><br /></div>If you notice any issues or potential for improvement, please let me know! :)<br /><div class="separator" style="clear: both; text-align: center;"></div></div>
